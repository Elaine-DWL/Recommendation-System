# UserCF概念整理及代码实战

## 基本概念

* **UserCF的做法**

  1. 根据**用户相似度矩阵**，找到和目标用户相似的用户集合
  2. 找到这个集合中的用户喜欢的，且目标用户没有接触的的物品推荐给目标用户

  上面是《推荐系统实践》中的2句原话。

  笔者的理解就是，找到目标用户最相似的$k$个用户，对这$k$个用户喜欢且目标用户没有接触过的物品，计算目标用户对它们的感兴趣程度，根据感兴趣程度取前$k$个推荐给目标用户。

* **如何度量用户相似度**

  * **Jaccard公式**

    $w_{uv} = \frac{|N(u) \bigcap N(v)|}{|N(u) \bigcup N(v)|}$

    其中，$w_{uv}$表示用户$u$, $v$之间的相似度，$N(u)$和$N(v)$分别表示用户$u$, $v$ **喜欢**的物品的集合。

  * **余弦相似度**

    $w_{uv} = \frac{|N(u) \bigcap N(v)|}{\sqrt{|N(u) N(v)|}}$

  * **改进的余弦相似度**

    现实情况中，如果两个用户同时喜欢某个冷门的商品，更能说明它们之间的兴趣相似。

    同样地，两个人用户都喜欢某个热门商品，反而并不是很能说明它们兴趣相似，反而可能只是”赶潮流“，并不能真正代表用户的“兴趣”。

    所以，我们可以对余弦公式进行改造，添加对**热门商品的惩罚。**可以理解为对商品进行**加权**，越冷门的商品权重越大即对用户相似度的贡献越大，越热门的商品权重越小。

    $$w_{uv} = \frac{\sum_{i\in N(u)\cap N(v)}{\frac{1}{log(1+N(i))}}}{\sqrt{(|N(u)|N(v))}}$$

* **如何度量用户对物品的感兴趣程度**

  $p(u, i) = \sum_{v\in{S(u, k)\cap N(i)}}w_{uv}r_{vi}$

  $p(u, i)$即为用户$u$对物品$i$的感兴趣程度，上式中，$S(u, k)$是和用户$u$最相似的$k$个用户，$N(i)$是所有对物品$i$有过行为的用户的集合，$r_{vi}$代表用户$v$对物品$i$的所有感兴趣程度。

* **UserCF中的参数**

  只有一个参数$K$。

  书上的大概就是这个意思，笔者自己认为，取多少个相似用户，以及取多少个物品做推荐，应该视具体应用环境而定。

## 代码实现

